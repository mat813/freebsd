# Copyright (c) 2003-2003
#	Fraunhofer Institute for Open Communication Systems (FhG Fokus).
#	All rights reserved.
#
# Author: Harti Brandt <harti@freebsd.org>
#
# $Begemot: bsnmp/trunk/lib/Makefile.in 1487 2008-12-23 19:03:33Z brandt_h $
#
SRCS=	asn1.c snmp.c snmpagent.c snmpclient.c support.c # snmptc.c
INCS=	asn1.h snmp.h snmpagent.h snmpclient.h ${builddir}/snmptc.h
MAN3=	asn1.3 bsnmplib.3 bsnmpclient.3 bsnmpagent.3
DEFS=	tc.def

LIB=	libbsnmp.la
SHLIB_MAJOR= 6
SHLIB_MINOR= 0

CFLAGS+= -I$(srcdir)

$(LIB): $(SRCS:.c=.lo) snmptc.h
	$(LIBTOOL) --mode=link $(CC) $(LDLAGS) -o $@ $(SRCS:.c=.lo) -rpath $(libdir) -version-info $(SHLIB_MAJOR):$(SHLIB_MINOR)

snmptc.h : tc.def
	( \
		echo -n "/* autogenerated from tc.def; " ; \
		ls -l -D "%F %T" $(srcdir)/tc.def | awk '{printf("%s %s",$$6,$$7)}' ; \
		echo "*/"; \
		echo "#ifndef snmptc_h_1529923773" ; \
		echo "#define snmptc_h_1529923773" ; \
		${top_builddir}/gensnmptree/gensnmptree -E -f <${srcdir}/tc.def ; \
		echo "#endif" ; \
	) >snmptc.h

CLEANFILES += snmptc.h *.3out
