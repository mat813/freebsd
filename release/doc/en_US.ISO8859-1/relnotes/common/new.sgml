<articleinfo>
  <title>&os;/&arch; &release.current; Release Notes</title>

  <pubdate>$FreeBSD$</pubdate>

  <corpauthor>The FreeBSD Project</corpauthor>

  <copyright>
    <year>2000</year>
    <year>2001</year>
    <holder role="mailto:doc@FreeBSD.org">The FreeBSD Documentation Project</holder>
  </copyright>

  <abstract>
    <para>The release notes for &os; &release.current; contain a summary
      of the changes made in the &os; base system since &release.prev;.
      Both changes for kernel and userland are listed, as well as
      applicable security advisories that were issued since the last
      release.  Some brief remarks on upgrading are also presented.</para>
  </abstract>
</articleinfo>

<sect1>
  <title>Introduction</title>

  <para>This document contains the release notes for &os; &release.current; on
  the &arch.print; hardware platform.  It describes new features of &os;
  that have been added (or changed) since &release.prev;.  It also
  provides some notes on upgrading from previous versions of &os;.</para>

<![ %release.type.snapshot [

  <para>The &release.type; distribution to which these release notes
  apply represents a point along the &release.branch; development
  branch between &release.prev; and the future &release.next;.  Some pre-built,
  binary &release.type; distributions along this branch can be found
  at <ulink url="&release.url;"></ulink>.</para>

]]>

<![ %release.type.release [

  <para>This distribution of &os; &release.current; is a &release.type;
  distribution.  It can be found at <ulink
  url="&release.url;"></ulink> or any of its mirrors.  More
  information on obtaining this (or other) &release.type; distributions of
  &os; can be found in the <ulink
  url="http://www.FreeBSD.org/handbook/mirrors.html"><quote>Obtaining
  FreeBSD</quote> appendix</ulink> to the <ulink
  url="http://www.FreeBSD.org/handbook/">FreeBSD Handbook</ulink>.</para>

]]>
</sect1>

<!--
	The "What's New" section of the release notes.  

	Guidelines for new entries:

	1.  If there is some obvious "keyword" associated with an
	entry (such as a manpage entry or an application name), try to
	put it at the start of the sentence.

	2.  Within each subsection (i.e. kernel, security, userland),
	list items in alphabetical order by these keywords.

	Some entries will have no obvious keywords to help with
	ordering.  In sections containing these entries, put those
	containing (e.g.) manpage references first, then some
	suitable SGML comment line as a demarc, then the remaining
	entries.

-->

<sect1>
  <title>What's New</title>

  <para>This section describes the most user-visible new or changed
  features in &os; since &release.prev;.  Typical release note items
  document new drivers or hardware support, new commands or options,
  major bugfixes, or contributed software upgrades.  Security
  advisories issued after &release.prev; are also listed.</para>

  <para>Many additional changes were made to &os; that are not listed
  here for lack of space.  For example, documentation was corrected
  and improved, minor bugs were fixed, insecure coding practices were
  audited and corrected, and source code was cleaned up.</para>

  <sect2 id="kernel">
    <title>Kernel Changes</title>

    <para arch="i386">The &man.amdpm.4; driver has been added to
    provide access to the system monitoring functions of the AMD 756
    chip set.</para>

    <para arch="i386">A new <varname>KVA_SPACE</varname> kernel option
    can be used to reconfigure the size of the kernel virtual address
    space.</para>

    <para arch="i386">The &man.loader.8; now has optional support
    (enabled at compile-time, off by default) for loading
    <application>bzip2</application>-compressed kernels and
    modules.</para>

    <para>Linux emulation now supports the kernel functionality
    required by the
    <port>emulators/linux_base-7</port> (RedHat 7.X emulation)
    port.</para>

    <para arch="alpha">A <varname>MAXMEM</varname> kernel option,
    along with the <varname>hw.physmem</varname> environment, can be
    used to artificially reduce the memory size of a machine for
    testing (or other purposes).</para>

    <para>The kernel configuration parameters
    <varname>MAXTSIZ</varname>, <varname>DFLDSIZ</varname>,
    <varname>MAXDSIZ</varname>, <varname>DFLSSIZ</varname>,
    <varname>MAXSSIZ</varname>, and <varname>SGROWSIZ</varname> are
    all loader tunables.</para>

    <para arch="i386">The pmc driver, which supports the power
    management controller of the NEC PC-98NOTE, has been
    added.</para>

    <para arch="alpha">The console driver has gained support for TGA-based
    display adapters.</para>

<!-- Above this line, kernel changes ordered by manpage/variable name -->

    <para arch="i386">The load addresses of kernels has been exported
    to the symbol table and various hard-coded constants removed so
    that utilities such as &man.ps.1; can work with kernels compiled
    at different addresses.</para>

    <para>Coredumps of large processes (or of a large number of
    processes) no longer lock up the machine for long periods of
    time.</para>

    <para arch="i386">The number of memory pages allocated for the
    per-process kernel state has been increased from 2 to 3, to reduce
    the likelihood of kernel stack overflow (and subsequent corruption
    of per-process data structures).</para>

    <para>The system load average computation now adds some jitter to
    the timing of samples, in order to avoid synchronization with
    processes that run periodically.</para>

    <sect3>
      <title>Processor/Motherboard Support</title>

      <para></para>
    </sect3>

    <sect3>
      <title>Network Interface Support</title>

      <para>The &man.an.4; driver now supports <quote>monitor</quote>
      mode, settable via the <option>-M</option> option to
      &man.ancontrol.8;.</para>

      <para arch="i386">The &man.bge.4; driver has been added to
      support the Broadcom BCM570x family of Gigabit Ethernet
      controllers, including the 3Com 3c996-T, the SysKonnect SK-9D21
      and SK-9D41, and the built-in Gigabit Ethernet NICs on Dell
      PowerEdge 2550 servers.  TCP/IP checksum offload, jumbo frames
      and VLAN tag insertion/stripping are supported, as well as
      interrupt moderation.</para>

      <para>The &man.de.4; driver now performs round-robin arbitration
      between transmit and receive unit of the 21143, instead of
      giving priority to the receive unit.  This gives a 10&ndash;15%
      performance improvement in the forwarding rate under heavy
      load.</para>

      <para>The dgm driver has been updated from &os; -CURRENT.</para>

      <para>The &man.fxp.4; driver now supports Intel's loadable
      microcode to implement receive-side interrupt coalescing and
      packet bundling, on NICs that support these features.  This
      support can be activated by the use of the
      <option>link0</option> option to &man.ifconfig.8;.</para>

      <para>The &man.gx.4; driver has been added to support NICs based
      on the Intel 82542 and 82543 Gigabit Ethernet controller chips.
      Both fiber and copper variants of the cards are supported.  Both
      boards support VLAN tagging/insertion, and the 82543 additionally
      supports TCP/IP checksum offload.</para>

      <para>The &man.xl.4; driver now supports send- and receive-side TCP/IP
      checksum offloading for NICs implementing this feature, such as
      the 3C905B, 3C905C, and 3C980C.</para>
    </sect3>

    <sect3>
      <title>Network Protocols</title>

      <para>&man.bridge.4; and &man.dummynet.4; have received some
      enhancements and bug fixes, and are now loadable
      modules.</para>

      <para>A bug in the TCP NewReno implementation, which could cause
      degraded throughput under certain circumstances, has been
      fixed.</para>

    </sect3>

    <sect3>
      <title>Disks and Storage</title>

      <para>The &man.aac.4; driver has been updated from &os;
      -CURRENT.  This update includes proper handling of commands
      initiated by the adapter, addition/removal of disk devices,
      crashdump functionality, and &man.ioctl.2; command necessary for
      the management CLI.</para>

      <para>The &man.isp.4; driver now supports the Qlogic 2300 and
      2312 Optical Fibre Channel PCI cards.</para>
    </sect3>

    <sect3>
      <title>Filesystems</title>

      <para>The directory layout preference algorithm for FFS has been
      changed to improve its speed on large filesystems.</para>

      <para>The virtual memory subsystem now backs UFS directory
      memory requirements by default (this behavior is controlled via
      the <varname>vfs.vmiodirenable</varname> sysctl variable.</para>
    </sect3>

    <sect3>
      <title>PCCARD Support</title>

      <para></para>
    </sect3>

    <sect3>
      <title>Multimedia Support</title>

      <para>The &man.urio.4; driver, for the Diamond Rio series of MP3
      players, has been added.  (For some reason, a manpage for this
      driver was committed to &os; 4.3-RELEASE.)</para>
    </sect3>

    <sect3>
      <title>Contributed Software</title>

      <para><application>IPFilter</application> now supports
      IPv6.</para>

    </sect3>
  </sect2>
  <sect2 id="security">
    <title>Security-Related Changes</title>

    <para>Per-user <filename>~/.login.conf</filename> files were disabled
    in &os; &release.prev; to avoid a security hole caused by a bug.
    The bug was fixed and this feature has been re-enabled.</para>

  </sect2>
  <sect2 id="userland">
    <title>Userland Changes</title>

    <para>&man.arp.8; now prints the applicable interface name for
    each ARP entry.</para>

    <para>&man.cat.1; now has the ability to read from UNIX-domain
    sockets.</para>

    <para arch="i386">The <filename>compat4x</filename> compatability
    distribution now includes versions of
    <filename>libcrypto.so.1</filename> and
    <filename>libssl.so.1</filename> that do not depend on the
    <filename>librsaUSA.so</filename> and
    <filename>librsaINTL.so</filename> libraries.  This change
    improves compatability with binaries built for &os; 4.1-RELEASE
    and older.</para>

    <para>&man.edquota.8; now takes a <option>-f</option> option to
    allow limiting the prototype quota distribution (specified with
    <option>-p</option>) to a single filesystem.</para>

    <para>&man.find.1; can now take various units of time to be
    applied to the <option>-[acm]time</option> primaries.</para>

    <para>&man.fmt.1; has been rewritten; the rewrite fixes a number
    of bugs compared to its prior behavior.</para>

    <para>&man.ipfw.8; will now avoid the display of dynamic
    firewall rules unless the <option>-d</option> flag is passed to
    it.  The <option>-e</option> option lists expired dynamic
    rules.</para>

    <para>&man.ipfw.8; has a new <literal>limit</literal> type of
    firewall rule, which limits the number of sessions between address
    pairs.</para>

    <para>&man.keyinfo.1; is now a C program, rather than a Perl
    script.</para>

    <para><filename>libstand</filename> now has support for
    filesystems containing <application>bzip2</application>-compressed
    files.</para>

    <para>&man.lpd.8; now has some support for
    <literal>o</literal>-type print-file actions in its control files,
    which allows printing of PostScript files generated by
    <application>MacOS</application> 10.1.</para>

    <para>&man.netstat.1; now has a <option>-z</option> flag to reset
    statistics.</para>

    <para>&man.netstat.1; now has a <option>-S</option> flag to print
    address numerically but port names symbolically.</para>

    <para>The default number of cylinders per group in &man.newfs.8;
    is now computed to be the maximum allowable given the current
    filesystem parameters.  It can be overridden with the
    <option>-c</option>.  Formerly, the default was fixed at 16.  This
    change leads to better &man.fsck.8; performance and reduced
    fragmentation.</para>

    <para>&man.newsyslog.8; now has the ability to ability to compress
    log files using &man.bzip2.1;.</para>

    <para>&man.nl.1;, a line numbering filter program, has been added.</para>

    <para>&man.ping.8; now supports a <option>-A</option> option to
    beep when packets are lost.</para>

    <para>&man.route.8; is now more verbose when changing indirect
    routes, in the case of a gateway route that is the same route as
    the one being modified.</para>

    <para>&man.route.8; now uses
    <literal><replaceable>host</replaceable>/<replaceable>bits</replaceable></literal>
    syntax instead of 
    <literal><replaceable>net</replaceable>/<replaceable>bits</replaceable></literal>
    syntax, for compatibility with &man.netstat.1;.</para>

    <para>&man.route.8; can now create <quote>proxy only</quote>
    published ARP entries.</para>

    <para>&man.sysinstall.8; now has the ability to load KLDs as a
    part of the installation.</para>

    <para>&man.syslogd.8; now has the ability to bind to a specific
    address--as opposed to using every available one--via the
    <option>-b</option> option.</para>

    <para>Previously, &man.vnconfig.8; was only capable of configuring
    16 devices when invoked with the <option>-f</option>
    (configuration file) option.  This limit has been removed.</para>

    <para>&man.wall.1; now supports a <option>-g</option> flag to
    write a message to all users of a given group.</para>

    <sect3>
      <title>Contributed Software</title>

      <para>The version of <application>IPFilter</application>
      provided with &os; now includes the &man.ipfs.8; program, which
      allows state information created for NAT entries and stateful
      rules to be saved to disk and restored after a reboot.</para>

      <para><application>OpenSSH</application> has been updated to
      version 2.9, which adds two new programs, &man.sftp.1; and
      &man.ssh-keyscan.1;.  Among the various enhancements: Rekeying
      of existing SSH sessions is now supported, &man.ssh-agent.1; now
      supports authentication forwarding for DSA keys, and an experimental
      <application>SOCKS4</application> proxy has been added to
      &man.ssh.1;.
        <note>
	  <para><literal>Protocol 1,2</literal> remains the default
          protocol setting in
          <filename>/etc/ssh/ssh_config</filename>.  In &os; -CURRENT,
          the default is <literal>Protocol 2,1</literal>.</para>
	</note>
      </para>

      <para><application>tcsh</application> has been updated to version
      6.11.</para>

      <para>The timezone database has been updated to the
      <filename>tzdata2001d</filename> release.</para>

      <sect4>
        <title>CVS</title>
      
	<para><application>CVS</application> has been updated to
	1.11.1p1.</para>

        <para>&man.cvs.1; now supports a <option>-T</option> option to
        update a sandbox's <filename>CVS/Template</filename> file from
        the repository.</para>

	<para>&man.cvs.1; <literal>diff</literal> now supports the
	<option>-j</option> option to perform differences against a
	revision relative to a branch tag.</para>
      </sect4>
    </sect3>

    <sect3>
      <title>Ports/Packages Collection</title>

      <para>&man.pkg.create.1; now supports a <option>-b</option>
      option to create a package file from a locally-installed
      package.</para>
    </sect3>
  </sect2>
</sect1>

<sect1>
  <title>Upgrading from previous releases of &os;</title>

  <para>If you're upgrading from a previous release of &os;, you
  generally will have three options:

    <itemizedlist>
      <listitem>
	<para>Using the binary upgrade option of &man.sysinstall.8;.
	  This option is perhaps the quickest, although it presumes
	  that your installation of &os; uses no special compilation
	  options.</para>
      </listitem>
      <listitem>
	<para>Performing a complete reinstall of &os;.  Technically,
	  this is not an upgrading method, and in any case is usually less
	  convenient than a binary upgrade, in that it requires you to
	  manually backup and restore the contents of
	  <filename>/etc</filename>.  However, it may be useful in
	  cases where you want (or need) to change the partitioning of
	  your disks.
      </listitem>
      <listitem>
	<para>From source code in <filename>/usr/src</filename>.  This
	  route is more flexible, but requires more disk space, time,
	  and more technical expertise.  Upgrading from very old
	  versions of &os; may be problematic; in cases like this, it
	  is usually more effective to perform a binary upgrade or a
	  complete reinstall.</para>
      </listitem>
    </itemizedlist>
  </para>

  <para>Please read the <filename>INSTALL.TXT</filename> file for more
  information, preferably <emphasis>before</emphasis> beginning an
  upgrade.  If you are upgrading from source, please be sure to read
  <filename>/usr/src/UPDATING</filename> as well.</para>

  <para>Finally, if you want to use one of various means to track the
  -STABLE or -CURRENT branches of &os;, please be sure to consult the
  <ulink
  url="http://www.FreeBSD.org/handbook/current-stable.html"><quote>-CURRENT
  vs. -STABLE</quote></ulink> section of the <ulink
  url="http://www.FreeBSD.org/handbook/">FreeBSD
  Handbook</ulink>.</para>

  <important>
    <para>Upgrading &os; should, of course, only be attempted after
    backing up <emphasis>all</emphasis> data and configuration
    files.</para>
  </important>
</sect1>

