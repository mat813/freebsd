<!DOCTYPE article PUBLIC "-//FreeBSD//DTD DocBook V4.1-Based Extension//EN" [
<!ENTITY % articles.ent PUBLIC "-//FreeBSD//ENTITIES DocBook FreeBSD Articles Entity Set//EN">
%articles.ent;

<!ENTITY % release PUBLIC "-//FreeBSD//ENTITIES Release Specification//EN">
%release;
]>

<article>
<articleinfo>
  <title>&os; &release.current; Release Notes</title>

  <corpauthor>The &os; Project</corpauthor>

  <pubdate>$FreeBSD$</pubdate>

  <copyright>
    <year>2012</year>
    <holder role="mailto:doc@FreeBSD.org">The &os; Documentation Project</holder>
  </copyright>

  <legalnotice id="trademarks" role="trademarks">
    &tm-attrib.freebsd;
    &tm-attrib.ibm;
    &tm-attrib.ieee;
    &tm-attrib.intel;
    &tm-attrib.sparc;
    &tm-attrib.general;
  </legalnotice>

  <abstract>
    <para>The release notes for &os; &release.current; contain a summary
      of the changes made to the &os; base system on the
      &release.branch; development line.
      This document lists applicable security advisories that were issued since
      the last release, as well as significant changes to the &os;
      kernel and userland.
      Some brief remarks on upgrading are also presented.</para>
  </abstract>
</articleinfo>

<sect1 id="intro">
  <title>Introduction</title>

  <para>This document contains the release notes for &os;
    &release.current;.  It
    describes recently added, changed, or deleted features of &os;.
    It also provides some notes on upgrading
    from previous versions of &os;.</para>

  <para>This distribution of &os; &release.current; is a
    &release.type; distribution.  It can be found at <ulink
    url="&release.url;"></ulink> or any of its mirrors.  More
    information on obtaining this (or other) &release.type;
    distributions of &os; can be found in the <ulink
    url="&url.books.handbook;/mirrors.html"><quote>Obtaining
    &os;</quote> appendix</ulink> to the <ulink
    url="&url.books.handbook;/">&os;
    Handbook</ulink>.</para>

  <para>All users are encouraged to consult the release errata before
    installing &os;.  The errata document is updated with
    <quote>late-breaking</quote> information discovered late in the
    release cycle or after the release.  Typically, it contains
    information on known bugs, security advisories, and corrections to
    documentation.  An up-to-date copy of the errata for &os;
    &release.current; can be found on the &os; Web site.</para>

</sect1>

<sect1 id="new">
  <title>What's New</title>

  <para>This section describes
    the most user-visible new or changed features in &os;
    since &release.prev;.</para>

  <para>Typical release note items
    document recent security advisories issued after
    &release.prev;,
    new drivers or hardware support, new commands or options,
    major bug fixes, or contributed software upgrades.  They may also
    list changes to major ports/packages or release engineering
    practices.  Clearly the release notes cannot list every single
    change made to &os; between releases; this document focuses
    primarily on security advisories, user-visible changes, and major
    architectural improvements.</para>

  <sect2 id="security">
    <title>Security Advisories</title>

      <para>Problems described in the following security advisories have
	been fixed.  For more information, consult the individual
	advisories available from
	<ulink url="http://security.FreeBSD.org/"></ulink>.</para>

      <informaltable frame="none" pgwide="1">
	<tgroup cols="3">
	  <colspec colwidth="1*">
	  <colspec colwidth="1*">
	  <colspec colwidth="3*">
	  <thead>
	    <row>
	      <entry>Advisory</entry>
	      <entry>Date</entry>
	      <entry>Topic</entry>
	    </row>
	  </thead>

	  <tbody>
	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:01.mountd.asc"
		  >SA-11:01.mountd</ulink></entry>
	      <entry>20&nbsp;April&nbsp;2011</entry>
	      <entry><para>Network ACL mishandling in &man.mountd.8;</para></entry>
	    </row>

	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:02.bind.asc"
		  >SA-11:02.bind</ulink></entry>
	      <entry>28&nbsp;May&nbsp;2011</entry>
	      <entry><para>BIND remote DoS with large RRSIG RRsets and negative
		  caching</para></entry>
	    </row>

	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:04.compress.asc"
		  >SA-11:04.compress</ulink></entry>
	      <entry>28&nbsp;September&nbsp;2011</entry>
	      <entry><para>Errors handling corrupt compress file in
		  &man.compress.1; and &man.gzip.1;</para></entry>
	    </row>

	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:05.unix.asc"
		  >SA-11:05.unix</ulink></entry>
	      <entry>28&nbsp;September&nbsp;2011</entry>
	      <entry><para>Buffer overflow in handling of UNIX socket
		  addresses</para></entry>
	    </row>

	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:06.bind.asc"
		  >SA-11:06.bind</ulink></entry>
	      <entry>23&nbsp;December&nbsp;2011</entry>
	      <entry><para>Remote packet Denial of Service against &man.named.8;
		  servers</para></entry>
	    </row>

	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:07.chroot.asc"
		  >SA-11:07.chroot</ulink></entry>
	      <entry>23&nbsp;December&nbsp;2011</entry>
	      <entry><para>Code execution via chrooted ftpd</para></entry>
	    </row>

	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:08.telnetd.asc"
		  >SA-11:08.telnetd</ulink></entry>
	      <entry>23&nbsp;December&nbsp;2011</entry>
	      <entry><para>telnetd code execution vulnerability</para></entry>
	    </row>

	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:09.pam_ssh.asc"
		  >SA-11:09.pam_ssh</ulink></entry>
	      <entry>23&nbsp;December&nbsp;2011</entry>
	      <entry><para>pam_ssh improperly grants access when user account has
		  unencrypted SSH private keys</para></entry>
	    </row>

	    <row>
	      <entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-11:10.pam.asc"
		  >SA-11:10.pam</ulink></entry>
	      <entry>23&nbsp;December&nbsp;2011</entry>
	      <entry><para><function>pam_start()</function> does not validate
		  service names</para></entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>
    </sect2>

  <sect2 id="kernel">
    <title>Kernel Changes</title>

      <para revision="219129">&os; kernel now supports Capsicum
	Capability Mode.  Capsicum is a set of features for sandboxing
	support, using a capability model in which the capabilities
	are file descriptors.  Two new kernel options
	<literal>CAPABILITIES</literal> and
	<literal>CAPABILITY_MODE</literal> have been added to
	<filename>GENERIC</filename> kernel.  For more information
	about Capsicum, see <ulink
	url="http://www.cl.cam.ac.uk/research/security/capsicum/"></ulink>.</para>

      <para revision="217152,217396" arch="amd64,i386,powerpc">&os; ELF image
	activator now supports <literal>PT_GNU_STACK</literal> program
	header.  This is disabled by default.  New &man.sysctl.8;
	variables <varname>kern.elf32.nxstack</varname> and
	<varname>kern.elf64.nxstack</varname> allow to enable
	<literal>PT_GNU_STACK</literal> for the specified ABIs
	(e.g. <literal>elf32</literal> for 32-bit ABI).</para>

      <para revision="218485,219028,219029">The following &man.sysctl.8; variables
	for showing availability of various kernel features:</para>

      <informaltable frame="none" pgwide="1">
	<tgroup cols="2">
	  <colspec colwidth="1*">
	  <colspec colwidth="3*">
	  <thead>
	    <row>
	      <entry>&man.sysctl.8; variable name</entry>
	      <entry>Description</entry>
	    </row>
	  </thead>

	  <tbody>
	    <row>
	      <entry><varname>kern.features.ufs_acl</varname></entry>
	      <entry>ACL (Access Control List) support in UFS</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.ufs_gjournal</varname></entry>
	      <entry>journaling support through &man.gjournal.8; for
		UFS</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.ufs_quota</varname></entry>
	      <entry>UFS disk quotas support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.ufs_quota64</varname></entry>
	      <entry>64-bit UFS disk quotas support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.softupdates</varname></entry>
	      <entry>FFS soft-updates support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.ffs_snapshot</varname></entry>
	      <entry>FFS snapshot support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.nfsclient</varname></entry>
	      <entry>NFS client (old implementation)</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.nfscl</varname></entry>
	      <entry>NFS client (new implementation)</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.nfsserver</varname></entry>
	      <entry>NFS server (old implementation)</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.nfsd</varname></entry>
	      <entry>NFS server (new implementation)</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.kdtrace_hooks</varname></entry>
	      <entry>Kernel DTrace hooks which are required to load
		DTrace kernel modules</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.ktr</varname></entry>
	      <entry>Kernel support for KTR kernel tracing facility</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.ktrace</varname></entry>
	      <entry>Kernel support for system call tracing</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.hwpmc_hooks</varname></entry>
	      <entry>Kernel support for HW PMC</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.sysv_msg</varname></entry>
	      <entry>System V message queues support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.sysv_sem</varname></entry>
	      <entry>System V semaphores support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.p1003_1b_mqueue</varname></entry>
	      <entry>POSIX P1003.1B message queues support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.p1003_1b_semaphores</varname></entry>
	      <entry>POSIX P1003.1B semaphores support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.kposix_priority_scheduling</varname></entry>
	      <entry>POSIX P1003.1B real-time extensions</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.stack</varname></entry>
	      <entry>Support for capturing kernel stack</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.sysv_shm</varname></entry>
	      <entry>System V shared memory segments support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.pps_sync</varname></entry>
	      <entry>Support usage of external PPS signal by kernel PLL</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.regression</varname></entry>
	      <entry>Kernel support for interfaces necessary for
		regression testing</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.invariant_support</varname></entry>
	      <entry>Support for modules compiled with INVARIANTS option</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.zero_copy_sockets</varname></entry>
	      <entry>Zero copy sockets support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.libmchain</varname></entry>
	      <entry>mchain library</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.scbus</varname></entry>
	      <entry>SCSI devices support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.mac</varname></entry>
	      <entry>Mandatory Access Control Framework support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.audit</varname></entry>
	      <entry>BSM audit support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_gate</varname></entry>
	      <entry>GEOM Gate module</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_uzip</varname></entry>
	      <entry>GEOM uzip read-only compressed disks support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_cache</varname></entry>
	      <entry>GEOM cache module</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_mirror</varname></entry>
	      <entry>GEOM mirroring support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_stripe</varname></entry>
	      <entry>GEOM striping support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_concat</varname></entry>
	      <entry>GEOM concatenation support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_raid3</varname></entry>
	      <entry>GEOM RAID-3 functionality</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_fox</varname></entry>
	      <entry>GEOM FOX redundant path mitigation support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_multipath</varname></entry>
	      <entry>GEOM multipath support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.g_virstor</varname></entry>
	      <entry>GEOM virtual storage support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_bde</varname></entry>
	      <entry>GEOM-based Disk Encryption</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_eli</varname></entry>
	      <entry>GEOM crypto module</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_journal</varname></entry>
	      <entry>GEOM journaling support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_shsec</varname></entry>
	      <entry>GEOM shared secret device support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_vol</varname></entry>
	      <entry>GEOM support for volume names from UFS superblock</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_label</varname></entry>
	      <entry>GEOM labeling support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_sunlabel</varname></entry>
	      <entry>GEOM Sun/Solaris partitioning support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_bsd</varname></entry>
	      <entry>GEOM BSD disklabels support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_pc98</varname></entry>
	      <entry>GEOM NEC PC9800 partitioning support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_linux_lvm</varname></entry>
	      <entry>GEOM Linux LVM partitioning support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_part_pc98</varname></entry>
	      <entry>GEOM partitioning class for PC-9800 disk partitions</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_part_vtoc8</varname></entry>
	      <entry>GEOM partitioning class for SMI VTOC8 disk labels</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_part_bsd</varname></entry>
	      <entry>GEOM partitioning class for BSD disklabels</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_part_ebr</varname></entry>
	      <entry>GEOM partitioning class for extended boot records support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_part_ebr_compat</varname></entry>
	      <entry>GEOM EBR partitioning class:
		backward-compatible partition names</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_part_gpt</varname></entry>
	      <entry>GEOM partitioning class for GPT partitions
		support</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_part_apm</varname></entry>
	      <entry>GEOM partitioning class for Apple-style
		partitions</entry>
	    </row>

	    <row>
	      <entry><varname>kern.features.geom_part_mbr</varname></entry>
	      <entry>GEOM partitioning class for MBR support</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>

    <sect3 id="boot">
      <title>Boot Loader Changes</title>

      <para></para>
    </sect3>

    <sect3 id="proc">
      <title>Hardware Support</title>

	<para revision="217044" arch="powerpc">&os;/powerpc now
	  supports Sony Playstation 3 using the OtherOS feature
	  available on firmwares 3.15 and earlier.</para>

      <sect4 id="mm">
	<title>Multimedia Support</title>

	<para></para>
      </sect4>

      <sect4 id="net-if">
	<title>Network Interface Support</title>

	  <para revision="217649">A bug in &man.alc.4; driver which
	    could make AR8152-based network interfaces stop working
	    has been fixed.</para>

	  <para revision="218794">A &man.cxgbe.4; driver for Chelsio
	    T4 (Terminator 4) based 10Gb/1Gb adapters has been
	    added.</para>

	  <para revision="218832" arch="i386">The &man.dc.4; driver
	    now works correctly in the kernel with
	    <option>PAE</option> option.</para>

	  <para revision="218530">The &man.igb.4; driver now supports
	    Intel I350 PCIe Gigabit Ethernet controller.</para>

	  <para revision="217593">The &man.ixgbe.4; driver has been
	    updated to version 2.3.8.</para>

	  <para revision="216860">A bug in &man.msk.4; driver has been
	    fixed.  It could prevent the RX checksum offloading from
	    working.</para>

	  <para revision="217794">A bug in &man.nfe.4; driver which
	    could prevent reinitialization after changing the MTU has
	    been fixed.</para>

	  <para revision="217511">A bug in &man.ral.4; and &man.run.4;
	    drivers which could prevent <literal>hostap</literal> mode
	    from working has been fixed.</para>

	  <para revision="216828">A rdcphy(4) driver for RDC Semiconductor
	    R6040 10/100 PHY has been added.</para>

	  <para revision="217498,218760">The &man.re.4; driver now supports
	    RTL8168E/8111E-VL PCIe Gigabit Ethernet controllers and
	    RTL8401E PCIe Fast Ethernet controller.</para>

	  <para revision="217766">The &man.re.4; driver now supports
	    TX interrupt moderation on RTL810xE PCIe Fast Ethernet
	    controllers.</para>

	  <para revision="217902">The &man.re.4; driver now supports
	    another mechanism for RX interrupt moderation because of
	    performance problem.  A &man.sysctl.8; variable
	    <varname>dev.re.<replaceable>N</replaceable>.int_rx_mod</varname>
	    has been added to control amount of time to delay RX
	    interrupt processing in units of microsecond.  Setting it
	    to <literal>0</literal> completely disables RX interrupt
	    moderation.  A &man.loader.8; tunable
	    <varname>hw.re.intr_filter</varname> controls whether the
	    old mechanism utilizing MSI/MSI-X capability on the
	    supported controllers is used or not.  When setting it to
	    a non-zero value, the &man.re.4; driver uses the old
	    mechanism.  The default value is <literal>0</literal> and
	    this tunable has no effect on controllers without MSI/MSI-X
	    capability.</para>

	  <para revision="217246,217832">The &man.re.4; driver now
	    supports TSO (TCP Segmentation Offload) on RealTek
	    RTL8168/8111 C or later controllers.  Note that this is
	    disabled by default because broken frames can be sent
	    under certain conditions.</para>

	  <para revision="217381,218289">The &man.re.4; driver now
	    supports enabling TX and/or RX checksum offloading
	    independently from each other.  Note that TX IP checksum
	    is disabled on some RTL8168C-based network interfaces
	    because it can generate an wrong IP checksum when the
	    packet contains IP options.</para>

	  <para revision="217296">A bug in the &man.re.4; driver has
	    been fixed.  It could cause a panic when receiving a jumbo
	    frame on an RTL8169C, 8169D, or 8169E controller-based
	    network interface.</para>

	  <para revision="217911">The &man.re.4; driver now support
	    RTL8105E PCIe Fast Ethernet controller.</para>

	  <para revision="217910">The rlphy(4) driver now support
	    Realtek RTL8201E 10/100 PHY found in RTL8105E
	    controller.</para>

	  <para revision="217548">A bug in the &man.sis.4; driver has
	    been changed.  It could prevent a proper reinitialization
	    on DP83815, DP83816, and SiS 900/7016 controllers when
	    configuration of multicast packet handling and/or
	    promiscuous mode is changed.</para>

	  <para revision="216650">A bug in &man.vlan.4; pseudo interface
	    han been fixed.  It could have a random interface
	    identifier in an automatically configured IPv6 link-local
	    address, instead of one generated with the parent
	    interface's IEEE 802 48-bit MAC address and an algorithm
	    described in RFC 4291.</para>

	  <para revision="216829">A &man.vte.4; driver for RDC R6040 Fast
	    Ethernet controller, which is commonly found on Vortex86
	    System On a Chip, has been added.</para>

	  <para revision="216824">A bug in &man.wpi.4; driver has been
	    fixed.  It could display the following error messages and
	    result in the device unusable:</para>

	  <screen>wpi0: could not map mbuf (error 12)
wpi0: wpi_rx_intr: bus_dmamap_load failed, error 12</screen>

      </sect4>
    </sect3>

    <sect3 id="net-proto">
      <title>Network Protocols</title>

	<para revision="218794">&os; &man.ipsec.4; support now uses a
	  half of the hash size as the authenticator hash size in
	  Hashed Message Authentication Mode (HMAC-SHA-256,
	  HMAC-SHA-384, and HMAC-SHA-512) as described in RFC 4868.
	  This was 96-bit fixed length in prior releases because the
	  implementation was based on an old Internet draft
	  draft-ietf-ipsec-ciph-sha-256-00.  Note that this means
	  &release.current; and later are no longer interoperable with
	  the older &os; releases.</para>

	<para revision="217169">A bug in &os; TCP/IP network stack has
	  been fixed.  The source address selection could not being
	  performed when multicast options were present but without an
	  interface being specified.</para>

	<para revision="216109,216114,216115,218152,218153,218155">
	  &os; TCP/IP network stack now supports &man.cc.9; pluggable
	  congestion control framework.  This allows TCP congestion
	  control algorithms to be implemented as dynamically loadable
	  kernel modules.  The following kernel modules are available
	  as of &release.current;: &man.cc.chd.4; for
	  CAIA-Hamilton-Delay algorithm, &man.cc.cubic.4; for CUBIC
	  algorithm, &man.cc.hd.4; for Hamilton-Delay algorithm,
	  &man.cc.htcp.4; for H-TCP algorithm, &man.cc.newreno.4; for
	  NewReno algorithm, and &man.cc.vegas.4; for Vegas algorithm.
	  The default algorithm can be set by a new &man.sysctl.8;
	  variable <varname>net.inet.tcp.cc.algorithm</varname>.  The
	  value must be set to one of the names listed by the
	  <varname>net.inet.tcp.cc.available</varname>, and
	  <literal>newreno</literal> is set at boot time.
	  For more
	  detail, see &man.cc.4; and &man.cc.9; manual pages.</para>

	<para revision="218912">A new &man.tcp.4; socket option
	  <literal>TCP_CONGESTION</literal> has been added.  This
	  allows to select or query a congestion control algorithm
	  that the TCP/IP network stack will use for connections on
	  the socket.</para>

	<para revision="219127">The &man.ng.one2many.4;
	  &man.netgraph.4; node now supports
	  <literal>XMIT_FAILOVER</literal> transmit algorithm.  This
	  makes packets deliver out the first active
	  <literal>many</literal> hook.</para>
    </sect3>

    <sect3 id="disks">
      <title>Disks and Storage</title>

	<para revision="218014">The &man.gpart.8; GEOM class now
	  supports the following aliases for the MBR and EBR schemes:
	  <literal>fat32</literal>, <literal>ebr</literal>,
	  <literal>linux-data</literal>,
	  <literal>linux-raid</literal>, and
	  <literal>linux-swap</literal>.</para>

	<para revision="218014">The &man.gpart.8; GEOM class now
	  supports <literal>bios-boot</literal> GUID for the GPT
	  scheme which is used in GRUB 2 loader.</para>

	<para revision="219056">The &man.sysctl.8; variable
	  <varname>kern.geom.confxml</varname> now contains
	  information about disk identification in an
	  <sgmltag>ident</sgmltag> tag and disk model string in a
	  <sgmltag>descr</sgmltag> tag.</para>

	<para revision="216793">The &man.md.4; memory-backed pseudo disk
	  device driver now supports a &man.sysctl.8; variable
	  <varname>vm.md_malloc_wait</varname> to specify whether a
	  malloc-backed disk to using <varname>M_WAITOK</varname> or
	  <varname>M_NOWAIT</varname> for &man.malloc.9; calls.  The
	  <varname>M_WAITOK</varname> can prevent memory allocation
	  failure under high load.  If it is set to
	  <literal>0</literal>, a malloc-backed disk uses
	  <varname>M_NOWAIT</varname> for memory allocation.  The
	  default value is <literal>0</literal>.</para>

	<para revision="216941,217509">A bug in the &man.mmc.4; driver
	  that could fail in device detection has been fixed.</para>

	<para revision="219089">ZFS subsystem has been updated to the
	  SPA (Storage Pool Allocator, also known as zpool) version
	  28.  It now supports data deduplication, triple parity RAIDZ
	  (raidz3), snapshot holds, log device removal, zfs diff,
	  zpool split, zpool import <option>-F</option>, and read-only
	  zpool import.</para>
      </sect3>

    <sect3 id="fs">
      <title>File Systems</title>

	<para revision="207141,218726">The &os; Fast File System now supports
	  softupdates journaling.  It introduces a intent log into a
	  softupdates-enabled file system which eliminates the need
	  for background &man.fsck.8; even on unclean shutdown.  This
	  can be enabled in a per-filesystem basis by using a
	  <option>-j</option> flag in the &man.newfs.8; utility or a
	  <option>-j enable</option> option in the &man.tunefs.8;
	  utility.  Note that the &release.current; installer
	  automatically enables the softupdates journaling for
	  newly-created UFS file systems.</para>

	<para revision="216796">The &os; Fast File System now supports
	  <literal>TRIM</literal> command when freeing data blocks.  A
	  new flag <option>-t</option> in the &man.newfs.8; and
	  &man.tunefs.8; utilities sets the TRIM-enable flag in a file
	  system.  The TRIM-enable flag makes the file system send a
	  delete request to the underlying device for each freed
	  block.  The <literal>TRIM</literal> command is specified as
	  Data Set Management Command in ATA8-ACS2 standard to carry
	  the information related to deleted data blocks to device,
	  especially for SSD (Solid-State Drive) for optimization.</para>

	<para revision="221124">The &os NFS subsystem has been
	  updated.  The new implementation supports NFS version 4 in
	  addition to 2 and 3.  The kernel options for the NFS server
	  and client are changed from <literal>NFSSERVER</literal> and
	  <literal>NFSCLIENT</literal> to <literal>NFSD</literal> and
	  <literal>NFSCL</literal>.  &man.sysctl.8; variables which
	  start with <varname>vfs.nfssrv.</varname> have been renamed
	  with <varname>vfs.nfsd.</varname>.  The NFS server now
	  supports <varname>vfs.nfsd.server_max_nfsvers</varname> and
	  <varname>vfs.nfsd.server_min_nfsvers</varname>
	  &man.sysctl.8; variables to specify the maximum and the
	  minimum version number which the server accepts.  The
	  default value is set to <literal>3</literal> and
	  <literal>2</literal>, respectively.</para>

	<para>To enable NFSv4, the following variables are needed on
	  the server side in &man.rc.conf.5;:</para>

	  <programlisting>nfsv_server_enable="YES"
nfsv4_server_enable="YES"
nfsuserd_enable="YES"</programlisting>

	<para>and the following line is needed in
	  <filename>/etc/exports</filename>:</para>

	<programlisting>V4: /</programlisting>

	<para>For more information about NFSv4 and its configuration,
	  see &man.nfsv4.4; and &man.exports.5; manual pages.</para>
    </sect3>
  </sect2>

  <sect2 id="userland">
    <title>Userland Changes</title>

      <para revision="217416">The &man.cpuset.1; utility now supports
	a <option>-C</option> flag to create a new cpuset and assign
	an existing process into that set, and an
	<literal>all</literal> keyword in <option>-l
	<replaceable>cpu-list</replaceable></option> option to specify
	all CPUs in the system.</para>

      <para revision="217505">A bug in the &man.fetch.1; utility which
	could prevent <command>STAT</command> FTP command from working
	properly has been fixed.</para>

      <para revision="218049">The &man.hastd.8; utility now drops
	<literal>root</literal> privileges of the worker processes to
	<literal>hast</literal> user.</para>

      <para revision="219019">An implementation of
	<function>iconv()</function> API libraries and utilities which
	are standardized in Single UNIX Specification have been
	imported.  These are based on NetBSD's Citrus implementation.
	Note that these are not built nor installed by default.  To
	build and install them, specify
	<literal>WITH_ICONV=yes</literal> in
	<filename>/etc/src.conf</filename> and rebuild the base system
	as described in &os Handbook (<ulink
	url="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/makeworld.html"></ulink>).</para>

      <para revision="217013">The &man.ifconfig.8; utility now
	supports <literal>fdx</literal>, <literal>flow</literal>,
	<literal>hdx</literal>, and <literal>loop</literal> keywords
	as aliases of <literal>full-duplex</literal>,
	<literal>flowcontrol</literal>,
	<literal>half-duplex</literal>,
	and <literal>loopback</literal>, respectively.</para>

      <para revision="217642">The &man.netstat.1; utility now does not
	expose internal scope address representation used in the &os;
	kernel, which is derived from KAME IPv6 stack, in the results
	of <command>netstat -ani</command> and <command>netstat
	  -nr</command>.</para>

      <para revision="218127">The &man.newsyslog.8; utility now
	supports &man.xz.1; compression.  An <literal>X</literal> flag
	in the optional field has been added to specify the
	compression.</para>

      <para revision="216823">A &man.poweroff.8; utility has been added.
	This is equivalent to:</para>

      <screen>&prompt.root; shutdown -p now</screen>

      <para revision="218397">The &man.ppp.8; utility now supports
	<command>iface name <replaceable>name</replaceable></command>
	and <command>iface description
	<replaceable>description</replaceable></command> commands.
	These have the same functionalities as <literal>name</literal>
	and <literal>description</literal> subcommands in the
	&man.ifconfig.8; utility.</para>

      <para revision="216695">The &man.rtld.1; runtime linker now supports
	shared objects as filters in ELF shared libraries.  Both
	standard and auxiliary filtering have been supported.  The
	&man.rtld.1; linker's processing of a filter defers loading a
	filtee until a filter symbol is referenced unless
	<varname>LD_LOADFLTR</varname> environment variable is defined
	or a <literal>-z loadfltr</literal> option was specified when
	the filter was created.</para>

      <para revision="217133">A race condition in the &man.sed.1;
	utility has been fixed.  When an <option>-i</option> option is
	specified, it could cause a short time window with no file
	with the original file name.</para>

      <para revision="216629">The &man.sh.1; program now supports
	<command>kill</command> as a built-in command.  This allows
	specifying <literal>%<replaceable>job</replaceable></literal>
	which is equivalent to the corresponding process group.  Note
	that this built-in command returns the exit status
	<literal>2</literal> instead of <literal>1</literal> if an
	fatal error occurs as other built-in commands do.</para>

      <para revision="217176,217472">A bug in the &man.sh.1; program has been
	fixed for POSIX conformance.  It could return an wrong exit
	status when an <command>exit</command> command with no
	parameter is specified in the <literal>EXIT trap</literal>
	handler, which is triggered when the shell terminates.
	In trap actions for other signals, <command>exit</command>
	command with no parameter returns an exit status corresponding
	to the received signal.</para>

      <para revision="217557">A bug in the &man.sh.1; program has been
	fixed.  When a foreground job exits on a signal, a message is
	printed to <filename>stdout</filename> about this. The buffer
	was not flushed after this which could result in the message
	being written to the wrong file if the next command was a
	built-in and had <filename>stdout</filename> redirected.</para>

      <para revision="217461">The &man.sh.1; program now supports a
	<option>--</option> flag in <command>trap</command> command to
	stop the option processing.</para>

      <para revision="217206"><literal>%builtin</literal> keyword
	support in <varname>$PATH</varname> variable has been removed
	in the &man.sh.1; program.  All built-in commands are always
	found before looking up directories in
	<varname>$PATH</varname>.</para>

      <para revision="218466">Arithmetic expression handling code in
	the &man.sh.1; program has been updated by importing code from
	<application>dash</application>.  It now supports conditional
	operator (<literal>?:</literal>) and a bug in evaluation of
	&amp;&amp; and || around an arithmetic expression has been
	fixed.</para>

      <para revision="218847">A &man.utxrm.8; utility has been added.
	This allows one to remove an entry from the
	<filename>utmpx</filename> database by hand. This is useful
	when a login daemon crashes or fails to remove the entry
	during shutdown.</para>

    <sect3 id="rc-scripts">
      <title><filename>/etc/rc.d</filename> Scripts</title>

      <para></para>
    </sect3>
  </sect2>

  <sect2 id="contrib">
    <title>Contributed Software</title>

      <para revision="222544"><literal>ACPI CA</literal> has been
	updated to version 20110527.</para>

      <para revision="228189"><application>ISC BIND</application> has
	been updated to version 9.8.1-P1.</para>

      <para revision="218822"><application>GNU binutils</application>
	has been updated to 2.17.50 (as of 3 July 2007), which is the
	last available version under GPLv2.</para>

      <para revision="224014"><literal>dialog</literal> has been
	updated to version 1.1-20110707.</para>

      <para revision="208954">The <application>LLVM</application>
	compiler infrastructure and the
	<application>clang</application>, a C language family
	front-end, version 3.0 have been imported.  Note that it is not
	used for building the &os; base system.  In &os; build
	infrastructure, the &man.clang.1;, &man.clang...1;, and
	&man.clang-cpp.1; utilities can be used in
	<varname>CC</varname>, <varname>CXX</varname>, and
	<varname>CPP</varname> &man.make.1; variables,
	respectively.</para>

      <para revision="218122">The <application>timezone</application>
	database has been updated to the
	<application>tzdata2011a</application> release.</para>

      <para revision="217698">&man.unifdef.1; utility has been updated
	to version 2.5.6.</para>

      <para>The <application>xz</application> program has been updated
	from 5.0.0 to 5.0.1 release.</para>
    </sect2>

  <sect2 id="ports">
    <title>Ports/Packages Collection Infrastructure</title>

    <para></para>
  </sect2>

  <sect2 id="releng">
    <title>Release Engineering and Integration</title>

      <para revision="218799">A new installer &man.bsdinstall.8; has
	been added and integrated into installation ISO images.  The
	&man.sysinstall.8; utility is also available for settings
	after the installation.</para>

      <para>The supported version of
	the <application>KDE</application> desktop environment
	(<filename role="package">x11/kde4</filename>) has been
	updated from 4.5.5 to 4.7.3.</para>
  </sect2>

  <sect2 id="doc">
    <title>Documentation</title>

    <para></para>

  </sect2>
</sect1>

<sect1 id="upgrade">
  <title>Upgrading from previous releases of &os;</title>

    <sect2>
      <title>Upgrading using freebsd-update(8) or source-based
	procedure</title>

  <para arch="amd64,i386">Beginning with &os; 6.2-RELEASE,
    binary upgrades between RELEASE versions (and snapshots of the
    various security branches) are supported using the
    &man.freebsd-update.8; utility.  The binary upgrade procedure will
    update unmodified userland utilities, as well as a unmodified GENERIC kernel
    distributed as a part of an official &os; release.
    The &man.freebsd-update.8; utility requires that the host being
    upgraded have Internet connectivity.</para>

  <para>Source-based upgrades (those based on recompiling the &os;
    base system from source code) from previous versions are
    supported, according to the instructions in
    <filename>/usr/src/UPDATING</filename>.</para>

  <important>
    <para>Upgrading &os; should, of course, only be attempted after
      backing up <emphasis>all</emphasis> data and configuration
      files.</para>
  </important>
    </sect2>

    <sect2>
      <title id="upgrade-pitfalls">User-visible incompatibilities</title>

      <para>This section describes notable incompatibilities which you
	might want to know before upgrading your system.</para>

      <sect3>
	<title>Update of <literal>dialog</literal></title>

	<para>The <literal>dialog</literal> library is used in &os;
	  new installer and &os; Ports Collection to display a dialog
	  window and allow users to select various options.  Note that
	  it is updated in &release.current; and there is several
	  differences in the key operation which might confuse users
	  who are familiar with releases prior to &release.current;.
	  For example, pushing enter key in a check list window is no
	  longer able to be used to check an item.  The new version
	  consistently supports space bar for selecting an item and
	  enter key for OK/Cancel selection.</para>
      </sect3>

      <sect3>
	<title>Partition Metadata Integrity Check</title>

	<para>&os; now checks the integrity of partition metadata when
	  a partition table is found on a disk though GEOM
	  <application>PART</application> subsystem.  This detection
	  is automatically performed when a disk device is ready.
	  GEOM <application>PART</application> class in the kernel
	  verifies all generic partition parameters obtained from the
	  disk metadata, and if some inconsistency is detected, the
	  partition table will be rejected with the following
	  diagnostic message:</para>

	<screen>GEOM_PART: Integrity check failed</screen>

	<para>This integrity check is enabled by default.  On a system
	  prior to &release.current;, the inconsistencies were
	  silently ignored.  Therefore, there is possibility that this
	  prevents a system from booting after upgrading it to
	  &release.current;.  More specifically, the kernel cannot
	  mount the system partition at boot time in some
	  cases.</para>

	<para>If this happens, a &man.loader.8; tunable
	  <varname>kern.geom.part.check_integrity</varname> can be
	  used as a workaround.  Enter the following lines in the
	  &man.loader.8; prompt at boot time:</para>

	<screen><userinput>set kern.geom.part.check_integrity="0"</userinput>
<userinput>boot</userinput></screen>

	<para>These commands temporarily disable the integrity check.
	  If it was the cause, the &os; kernel should detect the
	  partitions after entering the commands as prior releases
	  did.  This configuration can be added into
	  <filename>/boot/loader.conf</filename> like the
	  following:</para>

	<programlisting>kern.geom.part.check_integrity="0"</programlisting>

	<para>To check inconsistent metadata after booting on the
	  system, use the &man.gpart.8; utility on the system.  A
	  corrupted entry will be displayed like the following:</para>

	<screen>&prompt.user; gpart show
=>        63  1953525104  mirror/gm0  MBR  (931G) [CORRUPT]
          63  1953525105           1  freebsd  [active]  (931G)</screen>

	<para>For more information, see &man.gpart.8; manual page.</para>
      </sect3>
    </sect2>
</sect1>
</article>
